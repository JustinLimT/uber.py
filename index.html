<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <title>Uber.py by tals</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Uber.py</h1>
        <h2>Python client for <a href="https://www.uber.com">Uber</a></h2>

        <section id="downloads">
          <a href="https://github.com/tals/uber.py/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/tals/uber.py/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/tals/uber.py" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
      <a href="https://github.com/tals/uber.py">
        <img src="images/ubercli.gif" class="animgif-hack">
      </a>

<p>Installation:</p>


<pre><code>$ pip install uber.py
</code></pre>

<p>Running the CLI:</p>
<pre><code>$ ubercli
</code></pre>

<p>library usage example:</p>

<div class="highlight highlight-python"><pre><span class="kn">from</span> <span class="nn">uber</span> <span class="kn">import</span> <span class="n">UberClient</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">UberClient</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">'tal@test.org'</span><span class="p">,</span> <span class="s">'my_password'</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">UberClient</span><span class="p">(</span><span class="s">'tal@test.org'</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>

<span class="n">app_state</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">request_pickup</span><span class="p">(</span><span class="s">'182 Howard St, San Francisco'</span><span class="p">)</span>
</pre></div>

<h2>
<a name="rationale" class="anchor" href="#rationale"><span class="octicon octicon-link"></span></a>Rationale</h2>

<p>Right now we're in this weird stage where we have services that are insanely popular, yet lack even the most
basic of APIs.</p>

<p>That kinda sucks. Let's change that.</p>

<p>This library strives to act as a reference for other libraries, and expose as much functionality of the API as possible.</p>

<h2>
<a name="design" class="anchor" href="#design"><span class="octicon octicon-link"></span></a>Design</h2>

<p>Uber's clients are mostly stateless - for every request done against the server, Uber always returns the FULL STATE of the
app, with things like "what to put in the bottom bar", "is there a ride in progress" etc.</p>

<p>Since this is a Python library, and will typically be used in server/CLI environments, things that would normally be
queried by external systems (GPS location) are passed EXPLICITLY as arguments, rather than being queried via some callback.
Sadly it makes the API less convenient to use.</p>

<p>It would be really cool to have a "pleasant" client on top of this low-level one (e.g. have add_credit_card() return the payment
profile rather than the whole state, etc). Pull-requests are welcome :)</p>

<h2>
<a name="supported-features" class="anchor" href="#supported-features"><span class="octicon octicon-link"></span></a>Supported features</h2>

<ul>
<li>Order and cancel a ride</li>
<li>Add/remove credit/debit cards</li>
<li>See the drivers in the area</li>
</ul><h2>
<a name="support" class="anchor" href="#support"><span class="octicon octicon-link"></span></a>Support</h2>

<ul>
<li>Python 2.7</li>
<li>PyPy</li>
</ul>

<h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<h2>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h2>

<ul>
<li>examples/ubercli.py: a fairly complete example that shows you how to ping, get a ride and cancel it.</li>
</ul><h2>
<a name="authenticating-a-user" class="anchor" href="#authenticating-a-user"><span class="octicon octicon-link"></span></a>Authenticating a user</h2>

<div class="highlight highlight-python"><pre><span class="kn">from</span> <span class="nn">uber</span> <span class="kn">import</span> <span class="n">UberClient</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">UberClient</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">'tal@test.org'</span><span class="p">,</span> <span class="s">'my_password'</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">token</span>
<span class="s">'my_token'</span>
</pre></div>

<h2>
<a name="getting-the-app-state" class="anchor" href="#getting-the-app-state"><span class="octicon octicon-link"></span></a>Getting the app state</h2>

<div class="highlight highlight-python"><pre><span class="n">client</span> <span class="o">=</span> <span class="n">UberClient</span><span class="p">(</span><span class="s">'tal@test.org'</span><span class="p">,</span> <span class="s">'my_token'</span><span class="p">)</span>
<span class="n">app_state</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">ping</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">app_state</span><span class="o">.</span><span class="n">nearby_vehicles</span><span class="p">[</span><span class="n">UberVehicleType</span><span class="o">.</span><span class="n">UBERX</span><span class="p">]</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">uber</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">NearbyVehicles</span><span class="s">'&gt;</span>
    <span class="n">vehicle_paths</span><span class="p">:</span> <span class="p">{</span>
        <span class="n">d2c0de3b</span><span class="o">-</span><span class="mi">907</span><span class="n">f</span><span class="o">-</span><span class="mi">49</span><span class="n">a4</span><span class="o">-</span><span class="mi">8</span><span class="n">be8</span><span class="o">-</span><span class="mi">756</span><span class="n">b8a2049bd</span><span class="p">:</span>   <span class="p">[</span>
            <span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">uber</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">VehicleLocation</span><span class="s">'&gt;</span>
                <span class="n">course</span><span class="p">:</span> <span class="o">-</span><span class="mi">140</span>
                <span class="n">epoch</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">06</span> <span class="mo">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mf">46.996000</span><span class="p">,</span>
            <span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">uber</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">VehicleLocation</span><span class="s">'&gt;</span>
                <span class="n">course</span><span class="p">:</span> <span class="o">-</span><span class="mi">140</span>
                <span class="n">epoch</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">06</span> <span class="mo">04</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mf">00.995000</span><span class="p">,</span>
            <span class="o">...</span>
        <span class="p">]</span>
        <span class="mi">4</span><span class="n">b035b27</span><span class="o">-</span><span class="mi">1544</span><span class="o">-</span><span class="mi">44</span><span class="n">d5</span><span class="o">-</span><span class="mi">93</span><span class="n">ea</span><span class="o">-</span><span class="mi">7</span><span class="n">b3d6d33717a</span><span class="p">:</span>   <span class="p">[</span>
            <span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">uber</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">VehicleLocation</span><span class="s">'&gt;</span>
                <span class="n">course</span><span class="p">:</span> <span class="mi">170</span>
                <span class="n">epoch</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mo">06</span> <span class="mo">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mf">34.148000</span><span class="p">,</span>
            <span class="o">...</span>
        <span class="p">]</span>
    <span class="o">...</span>
    <span class="p">}</span>
    <span class="n">min_eta</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">eta_string</span><span class="p">:</span> <span class="s">u'1 minute'</span>
    <span class="n">eta_string_short</span><span class="p">:</span> <span class="s">u'1 min'</span>

</pre></div>

<h2>
<a name="getting-a-ride" class="anchor" href="#getting-a-ride"><span class="octicon octicon-link"></span></a>Getting a ride</h2>

<div class="highlight highlight-python"><pre><span class="kn">from</span> <span class="nn">uber</span> <span class="kn">import</span> <span class="n">geolocate</span><span class="p">,</span> <span class="n">UberVehicleType</span>
<span class="n">geo_address</span> <span class="o">=</span> <span class="n">geolocate</span><span class="p">(</span><span class="s">'182 Howard St, San Francisco'</span><span class="p">)</span>
<span class="n">app_state</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">request_pickup</span><span class="p">(</span><span class="n">geo_address</span><span class="p">,</span> <span class="n">UberVehicleType</span><span class="o">.</span><span class="n">UBERX</span><span class="p">)</span>
</pre></div>

<h2>
<a name="canceling" class="anchor" href="#canceling"><span class="octicon octicon-link"></span></a>Canceling</h2>

<div class="highlight highlight-python"><pre><span class="n">client</span><span class="o">.</span><span class="n">cancel_pickup</span><span class="p">()</span>
</pre></div>

<h2>
<a name="payments" class="anchor" href="#payments"><span class="octicon octicon-link"></span></a>Payments</h2>

<div class="highlight highlight-python"><pre><span class="n">state</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">add_payment</span><span class="p">(</span><span class="s">'1111222233334444'</span><span class="p">,</span> <span class="s">'01'</span><span class="p">,</span> <span class="s">'99'</span><span class="p">,</span> <span class="s">'123'</span><span class="p">,</span> <span class="s">'94111'</span><span class="p">,</span> <span class="s">'US'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">payment_profiles</span>
<span class="p">[</span>
    <span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">uber</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">PaymentProfile</span><span class="s">'&gt;</span>
        <span class="n">card_type</span><span class="p">:</span> <span class="s">u'Visa'</span>
        <span class="nb">id</span><span class="p">:</span> <span class="mi">123456</span>
        <span class="n">card_expiration</span><span class="p">:</span> <span class="mi">2099</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="o">+</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>
        <span class="n">use_case</span><span class="p">:</span> <span class="s">u'personal'</span>
        <span class="n">card_number</span><span class="p">:</span> <span class="s">u'4444'</span>
<span class="p">]</span>

<span class="n">client</span><span class="o">.</span><span class="n">delete_payment_profile</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span>
</pre></div>

<h2>
<a name="checking-for-surge-rates" class="anchor" href="#checking-for-surge-rates"><span class="octicon octicon-link"></span></a>Checking for surge rates</h2>

<div class="highlight highlight-python"><pre><span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">city</span><span class="o">.</span><span class="n">vehicle_views</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">view</span><span class="o">.</span><span class="n">surge</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">'{name} has x{multiplier} surge rate'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">view</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="n">view</span><span class="o">.</span><span class="n">surge</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
</pre></div>

<h1>
<a name="faq" class="anchor" href="#faq"><span class="octicon octicon-link"></span></a>FAQ</h1>

<p>Q: What?<br>
A: I was told by someone that I should have some projects on my Github account, so I figured that I might as well make
something cool</p>

<p>Q: Will I get banned for using this?<br>
A: Maybe! I hope not. As it stands right now, Uber <em>CAN</em> tell this library apart from their official apps, as it makes
no effort to look the same as them (It omits some fields, does not implement the caching mechanism etc).</p>

<p>Q: What's missing?<br>
A: bunch of stuff:</p>

<ul>
<li>Feeding events to Uber's analytics system (see <code>UberClient.Events</code> &amp; <code>UberClient._send_event</code>)</li>
<li>Driver's side</li>
<li>Leaving feedback</li>
<li>PayPal integration</li>
</ul><p>Q: What about Lyft/Sidecar/Flywheel/omg there are so many of these<br>
A: I've written a library for Lyft, but I'm sitting on it for now as I want to gauge interest first (plus I don't want
to get banned from Lyft).
About the others - I honestly don't use them at all, but we'll see!</p>

<p>Q: Anything else?<br>
A: I'll buy a cookie to the first person who will write a Twilio-Uber mashup that lets people order Uber with a text.
What's cool about it is that it will allow people with feature phones to use Uber.
I was thinking of something like:</p>

<pre><code>&gt;&gt; Pickup UberX 182 Howard St, San Francisco
&lt;&lt; Scheduling a pickup to 182 Howard Street, San Francisco, CA 94105, USA
&lt;&lt; John will pick you up in 5 mins with a green Toyota Prius.
&gt;&gt; ping
&lt;&lt; John will pick you up in 2 mins with a green Toyota Prius.
&gt;&gt; cancel
&lt;&lt; ride has been cancelled.
</code></pre>
      </section>
    </div>

    
  </body>
</html>